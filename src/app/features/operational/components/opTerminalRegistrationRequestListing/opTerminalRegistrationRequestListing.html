<p-toolbar class="mb-4">
  <ng-template #start>
    <p-button label="Refresh" icon="pi pi-refresh" class="mr-2" (onClick)="load()"></p-button>
  </ng-template>
</p-toolbar>

<p-confirmDialog></p-confirmDialog>

<p-table #dt [value]="requests()" [paginator]="true" [rows]="10" dataKey="autoid" [loading]="loading()">
  <ng-template pTemplate="loading">
    <tr *ngFor="let _ of [0,1,2,3,4]">
      <td colspan="6">
        <div class="flex items-center gap-4 py-2">
          <p-skeleton shape="circle" size="2rem"></p-skeleton>
          <div class="flex-1">
            <p-skeleton width="60%" height="1rem"></p-skeleton>
            <p-skeleton width="40%" height="0.8rem" style="margin-top:6px"></p-skeleton>
          </div>
        </div>
      </td>
    </tr>
  </ng-template>

  <ng-template #header>
    <tr>
      <th>ID</th>
      <th>Created</th>
      <th>Status</th>
      <th>MAC</th>
      <th>PC Name</th>
      <th>Acceptance</th>
    </tr>
  </ng-template>

  <ng-template #body let-r>
    <tr>
      <td>{{ r.autoid }}</td>
      <td>{{ r.createddate | date:'dd-MMM-yyyy HH:mm' }}</td>
      <td><p-tag [value]="r.status" [severity]="getSeverity(r.status)"></p-tag></td>
      <td>{{ r.macAddress }}</td>
      <td>{{ r.pcName || '-' }}</td>
      <td class="flex items-center gap-2">
        <p-tag [value]="r.acceptanceStatus || 'Pending'" [severity]="getSeverity(r.acceptanceStatus || 'pending')"></p-tag>
        <div class="flex gap-2">
          <p-button icon="pi pi-check" class="p-button-sm " (onClick)="confirmApprove(r)"></p-button>
          <p-button icon="pi pi-times" class="p-button-sm" (onClick)="confirmReject(r)"></p-button>
          <p-button icon="pi pi-refresh" class="p-button-sm" (onClick)="confirmPending(r)"></p-button>
        </div>
      </td>
    </tr>
  </ng-template>

  <ng-template pTemplate="emptymessage">
    <tr>
      <td colspan="6">No registration requests found.</td>
    </tr>
  </ng-template>
</p-table>
